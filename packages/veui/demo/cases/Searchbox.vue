<template>
<article class="veui-searchbox-demo">
  <h1><code>&lt;veui-searchbox&gt;</code></h1>
  <section class="has-margin-right">
    <h2>sizes</h2>
    <p>
      <veui-searchbox
        clearable
        ui="xs"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
      <veui-searchbox
        clearable
        ui="s"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
    </p>
    <p>
      <veui-searchbox
        clearable
        ui="m"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
      <veui-searchbox
        clearable
        ui="l"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
    </p>
    <p>
      <veui-searchbox
        clearable
        ui="strong xs"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
      <veui-searchbox
        clearable
        ui="strong s"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
    </p>
    <p>
      <veui-searchbox
        clearable
        ui="strong m"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
      <veui-searchbox
        clearable
        ui="strong l"
        replace-on-select
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions4"
        @input="handleSuggest('4', $event)"
        @search="log($event)"
        @select="log('select', $event)"
      />
    </p>
  </section>
  <section class="has-margin-right">
    <h2>styles</h2>
    <p>
      <veui-searchbox
        ui="m"
        :name="name"
        :placeholder="placeholder"
        @search="log($event)"
      />
      <veui-searchbox
        ui="m strong"
        :name="name"
        :placeholder="placeholder"
        @search="log($event)"
      />
    </p>
  </section>
  <section class="has-margin-right">
    <h2>disabled</h2>
    <p>
      <veui-searchbox
        :value="value"
        :name="name"
        clearable
        :placeholder="placeholder"
        disabled
        @search="log($event)"
      />
      <veui-searchbox
        ui=" strong"
        disabled
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions5"
        @input="handleSuggest('5', $event)"
        @search="log($event)"
      />
    </p>
  </section>
  <section class="has-margin-right">
    <h2>readonly</h2>
    <p>
      <veui-searchbox
        :value="value"
        :name="name"
        clearable
        :placeholder="placeholder"
        readonly
        @search="log($event)"
      />
      <veui-searchbox
        :value="value"
        :name="name"
        clearable
        ui="strong"
        :placeholder="placeholder"
        readonly
        @search="log($event)"
      />
    </p>
  </section>
  <section class="has-margin-right">
    <h2>suggestions</h2>
    <p>
      <veui-searchbox
        v-model="value2"
        clearable
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions1"
        suggest-trigger="focus"
        @suggest="asyncHandleSuggest('1', $event)"
        @search="log($event)"
        @select="value2 = $event.label"
      />
      <veui-searchbox
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions8"
        suggest-trigger="focus"
        @search="log($event)"
        @suggest="suggestHandler"
      >
        <template
          slot="suggestion"
          slot-scope="suggestion"
        >
          <span>{{ suggestion.value }}</span>
          <icon name="eye"/>
        </template>
      </veui-searchbox>
      <veui-searchbox
        :name="name"
        :placeholder="placeholder"
        :suggestions="suggestions9"
        replace-on-select
        @input="handleSuggest('7', $event)"
        @search="log($event)"
      >
        <template slot="suggestions-before">
          <h3>header</h3>
        </template>
        <template
          slot="group-label"
          slot-scope="{ label }"
        >
          1👉 {{ label }}
        </template>
        <template
          slot="option-label"
          slot-scope="{ label }"
        >
          2👉 {{ label }}
        </template>
        <template slot="suggestions-after">
          <h3>ender</h3>
        </template>
      </veui-searchbox>
    </p>
  </section>
</article>
</template>

<script>
import bus from '../bus'
import { includes } from 'lodash'
import { Searchbox, Icon } from 'veui'

export default {
  name: 'demo-searchbox',
  components: {
    'veui-searchbox': Searchbox,
    Icon
  },
  data () {
    return {
      name: 'name',
      value: '测试值',
      value2: null,
      value3: '测试值',
      value4: '测试值',
      valueis: '测试值',
      placeholder: '百度(placeholder)',
      suggestions1: [],
      suggestions2: [],
      suggestions3: [],
      suggestions4: [],
      suggestions5: [],
      suggestions6: [],
      suggestions7: [],
      suggestions8: [
        {
          value: '百度',
          label: '百度'
        },
        {
          value: '百度贴吧',
          label: '百度贴吧'
        },
        {
          value: '百度MVP',
          label: '百度MVP'
        }
      ],
      suggestions9: [
        {
          label: '汽车',
          options: [
            { label: 'camry', value: 'camry' },
            { label: 'carola', value: 'carola' }
          ]
        }
      ],
      suggestionsis: []
    }
  },
  methods: {
    handleSuggest (num, value) {
      if (value && num) {
        this[`suggestions${num}`] = [
          {
            value,
            label: value
          },
          {
            value: '百度',
            label: '百度'
          },
          {
            value: '百度贴吧',
            label: '百度贴吧'
          },
          {
            value: '百度MVP',
            label: '百度MVP'
          }
        ]
      } else {
        this[`suggestions${num}`] = [
          '',
          '百度',
          '百度贴吧',
          '百度MVP',
          '百度指数'
        ]
      }
    },
    asyncHandleSuggest (num, value) {
      setTimeout(() => {
        if (value && num < 3) {
          this[`suggestions${num}`] = [
            {
              value,
              label: value
            },
            {
              value: '百度',
              label: '百度'
            },
            {
              value: '百度贴吧',
              label: '百度贴吧'
            },
            {
              value: '百度MVP',
              label: '百度MVP'
            }
          ]
        } else {
          this[`suggestions${num}`] = [
            '',
            '百度',
            '百度贴吧',
            '百度MVP',
            '百度指数'
          ]
        }
      }, 1000)
    },
    log (item) {
      bus.$emit('log', item)
    },
    suggestHandler (value) {
      this.suggestions8 = this.suggestions8.map(item => {
        item.hidden = !(
          includes(item.label, value) || includes(item.value, value)
        )
        return item
      })
    }
  }
}
</script>
<style lang="less">
.veui-searchbox-demo {
  .has-margin-right {
    .veui-searchbox {
      margin-right: 15px;
    }
  }
}
</style>
