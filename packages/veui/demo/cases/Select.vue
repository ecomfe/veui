<template>
<article>
  <h1>
    <code>&lt;veui-select&gt;</code>
  </h1>
  <section>
    <h2>4 ç§å¤§å°ï¼š</h2>
    <veui-form>
      <veui-field
        v-for="ui in sizes"
        :key="ui"
        :ui="ui"
        :label="ui"
      >
        <veui-select
          v-model="defaultValue1"
          :ui="ui"
          v-bind="attrs"
          placeholder="å…¨éƒ¨"
          clearable
          :filter="filter"
        />
      </veui-field>
    </veui-form>
  </section>
  <section>
    <h2>é»˜è®¤æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      clearable
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼ï¼šxs (å®šåˆ¶ max)</h2>
    <veui-select
      v-model="defaultMultiValue"
      ui="xs"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      :max="3"
      clearable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼ï¼šs (è‡ªå®šä¹‰ tag slot)</h2>
    <veui-select
      v-model="defaultMultiValue"
      ui="s"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      clearable
      multiple
    >
      <template
        slot="tag"
        slot-scope="{ label }"
      >
        <i>{{ label }}</i>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼</h2>
    <veui-select
      v-model="defaultMultiValue"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      clearable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼ï¼šm (é»˜è®¤)</h2>
    <veui-select
      v-model="defaultMultiValue"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      clearable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼ï¼šl</h2>
    <veui-select
      v-model="defaultMultiValue"
      ui="l"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      clearable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼ï¼šæœ‰é™åˆ¶</h2>
    <veui-select
      v-model="defaultMultiValue"
      placeholder="å…¨éƒ¨"
      v-bind="attrs"
      :max="4"
      clearable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰æ ·å¼ï¼šç¦ç”¨</h2>
    <veui-select
      v-model="defaultMultiValue"
      v-bind="attrs"
      placeholder="å…¨éƒ¨"
      clearable
      multiple
      disabled
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¯æœç´¢Selectï¼š</h2>
    <veui-select
      v-model="defaultValue2"
      v-bind="attrs"
      ui="checkmark"
      searchable
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¯æœç´¢Selectï¼š(è‡ªå®šä¹‰ label slot)</h2>
    <veui-select
      v-model="defaultValue2"
      v-bind="attrs"
      ui="checkmark"
      searchable
    >
      <template #label="{ label }">
        {{ label }}
        <veui-icon name="flag"/>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¯æœç´¢Selectï¼š(è‡ªå®šä¹‰ selected slot)</h2>
    <veui-select
      v-model="defaultValue2"
      v-bind="attrs"
      ui="checkmark"
      searchable
    >
      <template #selected="{ label }">
        {{ label }}
        <veui-icon name="flag"/>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¯æœç´¢å¤šé€‰Selectï¼š</h2>
    <veui-select
      v-model="defaultSearchMultiValue"
      v-bind="attrs"
      searchable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¯æœç´¢å¤šé€‰Selectï¼š(è‡ªå®šä¹‰ label slot)</h2>
    <veui-select
      v-model="defaultSearchMultiValue"
      v-bind="attrs"
      searchable
      multiple
    >
      <template
        #label="{ selected }"
      >{{ selected[0].label }}ç­‰{{ selected.length }}ä¸ª{{ ' ' }}</template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¤šé€‰Selectï¼š(è‡ªå®šä¹‰ selected slot)</h2>
    <veui-select
      v-model="defaultSearchMultiValue"
      v-bind="attrs"
      multiple
    >
      <template
        #selected="{ selected }"
      >{{ selected[0].label
      }}{{ selected.length > 1 ? `ç­‰${selected.length}ä¸ª` : '' }}</template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å¯æœç´¢å¤šé€‰Selectï¼šæœ‰é™åˆ¶</h2>
    <veui-select
      v-model="defaultSearchMultiValue"
      v-bind="attrs"
      :max="4"
      searchable
      multiple
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>åªè¯»æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue1"
      v-bind="attrs"
      readonly
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>ç¦ç”¨æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue1"
      v-bind="attrs"
      disabled
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>Slot[name=option-label] æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue3"
      v-bind="attrs"
      ui="alt"
    >
      <template
        slot="option-label"
        slot-scope="props"
      >
        <span class="veui-option-custom-label">{{ props.label }}</span>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>Slot æ ·å¼ 2ï¼š</h2>
    <veui-select
      v-model="defaultValue4"
      v-bind="attrs"
    >
      <template
        slot="option"
        slot-scope="props"
      >
        <span class="veui-option-label-text">{{ props.label }}</span>
        <veui-icon name="flag"/>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>Slot æ ·å¼ 3ï¼š</h2>
    <veui-select
      v-model="defaultValue1"
      v-bind="attrs"
    >
      <template
        slot="option"
        slot-scope="props"
      >
        <veui-radio :checked="props.selected">{{ props.label }}</veui-radio>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å†…è”æ ·å¼ï¼š</h2>
    <veui-select
      v-model="hero"
      multiple
    >
      <veui-option-group
        position="popup"
        trigger="hover"
      >
        <template slot="label">ä¸­å›½ ğŸ‡¨ğŸ‡³</template>
        <veui-option-group
          label="äº’è”ç½‘"
          position="popup"
        >
          <veui-option
            value="baidu"
            label="ç™¾åº¦"
          />
          <veui-option
            value="alibaba"
            label="é˜¿é‡Œå·´å·´"
          />
          <veui-option
            value="tencent"
            label="è…¾è®¯"
            disabled
          />
        </veui-option-group>
        <veui-option-group
          label="é€šä¿¡"
          position="popup"
        >
          <veui-option
            value="telecom"
            label="ä¸­å›½ç”µä¿¡"
          />
          <veui-option
            value="mobile"
            label="ä¸­å›½ç§»åŠ¨"
          />
        </veui-option-group>
      </veui-option-group>
      <veui-option-group
        label="ç¾å›½"
        position="popup"
      >
        <veui-option-group
          label="äº’è”ç½‘"
          position="popup"
        >
          <veui-option
            value="google"
            label="Google"
          />
          <veui-option
            value="facebook"
            label="Facebook"
          />
          <veui-option
            value="twitter"
            label="Twitter"
          />
        </veui-option-group>
        <veui-option-group
          label="é€šä¿¡"
          position="popup"
        >
          <veui-option
            value="atnt"
            label="AT&T"
          />
          <veui-option
            value="verizon"
            label="Verizon"
          />
        </veui-option-group>
      </veui-option-group>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å†…è”æ ·å¼ 2ï¼š</h2>
    <veui-select v-model="phone">
      <veui-option-group label="å›½äº§">
        <veui-option
          value="xiaomi"
          label="å°ç±³"
        />
        <veui-option
          value="oppo"
          label="OPPO"
        />
        <veui-option
          value="vivo"
          label="vivo"
        />
        <veui-option
          value="smartisan"
          label="åšæœ"
        />
      </veui-option-group>
      <veui-option-group
        label="éå›½äº§"
        position="popup"
      >
        <veui-option-group
          label="ç¾å›½"
          position="popup"
        >
          <veui-option
            value="apple"
            label="Apple"
          />
          <veui-option
            value="google"
            label="Google"
          />
        </veui-option-group>
        <veui-option-group
          label="æ—¥æœ¬"
          position="popup"
        >
          <veui-option
            value="sharp"
            label="å¤æ™®"
          />
          <veui-option
            value="sony"
            label="ç´¢å°¼"
          />
        </veui-option-group>
        <veui-option-group
          label="éŸ©å›½"
          position="popup"
        >
          <veui-option
            value="samsung"
            label="ä¸‰æ˜Ÿ"
          />
          <veui-option
            value="lg"
            label="LG"
          />
        </veui-option-group>
      </veui-option-group>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>åŠ¨æ€å†…è”æ ·å¼ï¼š</h2>
    <section>
      <veui-select
        searchable
        @input="keyword = $event"
      >
        <template v-if="keyword">
          <veui-option
            v-for="option in result"
            :key="option.value"
            :value="option.value"
            :label="option.label"
          />
        </template>
      </veui-select>
      <veui-button>OK</veui-button>
    </section>
  </section>
  <section>
    <h2>å¤æ‚è‡ªå®šä¹‰æ ·å¼ï¼š</h2>
    <section>
      <veui-select
        v-model="complex"
        multiple
        clearable
        searchable
        :options="complexResult"
        @input="handleSearch"
      >
        <template v-if="complexResult">
          <veui-option
            v-for="o in complexResult"
            :key="o.value"
            :label="o.label"
            :value="o.value"
          />
        </template>
        <template v-else>
          <veui-option-group
            v-for="(group, i) in complexData"
            :key="i"
            :label="group.label"
            position="popup"
          >
            <template v-for="(g, j) in group.options">
              <veui-option-group
                v-if="g.options"
                :key="j"
                position="popup"
                :label="g.label"
                :options="g.options"
              />
              <veui-option
                v-else
                :key="j"
                :label="g.label"
                :value="g.value"
              />
            </template>
            <template
              v-if="group.label === 'ä¸šåŠ¡ç‚¹'"
              #before
            >
              <div class="note">
                <veui-icon name="info-circle"/>
                <div class="text">
                  æ­¤å¤„ä»…æ˜¾ç¤ºä¸šåŠ¡ç‚¹ Top nï¼Œæ‚¨å¯é€šè¿‡æœç´¢æ·»åŠ å…¶å®ƒä¸šåŠ¡ç‚¹æ ‡ç­¾ã€‚
                </div>
              </div>
            </template>
          </veui-option-group>
        </template>
      </veui-select>
      <veui-button>OK</veui-button>
    </section>
    <section>
      <veui-select
        v-model="complex2"
        multiple
      >
        <template v-if="loaded">
          <veui-option-group
            label="Foo"
            position="popup"
          >
            <template #before>NOTE Foo</template>
            <veui-option
              label="Foo1"
              value="foo1"
            />
          </veui-option-group>
        </template>
      </veui-select>
      <veui-button>OK</veui-button>
    </section>
  </section>
  <section style="margin-top:500px;">
    <h2>å¯æœç´¢åˆ†ç»„æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue5"
      v-bind="optGroupAttrs"
      searchable
      :overlay-options="{ local: true }"
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>æ˜¾ç¤ºå·²é€‰å›¾æ ‡åˆ†ç»„æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue6"
      v-bind="optGroupAttrs"
      ui="checkmark"
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>Slot åˆ†ç»„æ ·å¼ 1ï¼š</h2>
    <veui-select
      v-model="defaultValue7"
      v-bind="optGroupAttrs"
    >
      <template
        slot="option"
        slot-scope="props"
      >
        <div class="veui-option-custom">{{ props.label }}</div>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>Slot[name=option] åˆ†ç»„æ ·å¼ 2ï¼š</h2>
    <veui-select
      v-model="defaultValue8"
      v-bind="optGroupAttrs"
    >
      <template
        slot="option"
        slot-scope="props"
      >
        <span class="veui-option-label-text veui-option-custom-label">{{
          props.label
        }}</span>
        <veui-icon name="gift"/>
      </template>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>åˆ†éš”çº¿æ ·å¼ï¼š</h2>
    <veui-select
      v-model="defaultValue9"
      v-bind="optGroupAttrs"
      :options="groupedOpts"
    />
    <veui-button>OK</veui-button>
  </section>
  <section>
    <h2>å†…è”æ ·å¼ 3ï¼š</h2>
    <veui-select
      v-model="defaultValue10"
      clearable
    >
      <template
        slot="group-label"
        slot-scope="{ label }"
      >
        <b>{{ label }}</b>
      </template>
      <veui-option-group label="å­—æ¯">
        <veui-option
          value="A"
          label="é€‰é¡¹ A"
        />
        <veui-option
          value="B"
          label="é€‰é¡¹ B"
        />
        <veui-option
          value="C"
          label="é€‰é¡¹ C"
        />
      </veui-option-group>
      <veui-option-group label="æ•°å­—">
        <veui-option
          value="1"
          label="é€‰é¡¹ 1"
        />
        <veui-option
          value="2"
          label="é€‰é¡¹ 2"
        />
        <veui-option
          value="3"
          label="é€‰é¡¹ 3"
        />
      </veui-option-group>
    </veui-select>
    <veui-button>OK</veui-button>
  </section>
</article>
</template>

<script>
import bus from '../bus'
import {
  Icon,
  Select,
  Option,
  OptionGroup,
  Radio,
  Field,
  Form,
  Button
} from 'veui'
import type from 'veui/managers/type'
import 'vue-awesome/icons/flag'
import 'vue-awesome/icons/gift'
import 'veui-theme-dls-icons/info-circle'

export default {
  name: 'select-demo',
  components: {
    'veui-select': Select,
    'veui-option': Option,
    'veui-option-group': OptionGroup,
    'veui-radio': Radio,
    'veui-icon': Icon,
    'veui-field': Field,
    'veui-form': Form,
    'veui-button': Button
  },
  data () {
    return {
      filter: ({ label }) => {
        return label.indexOf(this.keyword) !== -1
      },
      keyword: '',
      phone: null,
      hero: ['baidu', 'tencent'],
      disabled: true,
      complex: ['1', '2'],
      complex2: [],
      loaded: false,
      icon: true,
      defaultValue: null,
      defaultMultiValue: null,
      defaultSearchMultiValue: [1, 3],
      defaultValue1: null,
      defaultValue2: 2,
      defaultValue3: null,
      defaultValue4: null,
      defaultValue5: null,
      defaultValue6: null,
      defaultValue7: null,
      defaultValue8: '1-1',
      defaultValue9: null,
      defaultValue10: null,
      sizes: ['xs', 's', 'm', 'l'],
      attrs: {
        name: 'age',
        readonly: false,
        disabled: false,
        clearable: true,
        options: [
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹111',
            value: 1
          },
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹ä¸‹æ‹‰é€‰é¡¹ä¸‹æ‹‰é€‰é¡¹112',
            value: 2
          },
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹122',
            value: 3,
            disabled: true
          },
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹222',
            value: 4
          }
        ]
      },
      optGroupAttrs: {
        name: 'name',
        readonly: false,
        disabled: false,
        clearable: true,
        options: [
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹1',
            position: 'popup',
            options: [
              {
                label: 'å­é€‰é¡¹1',
                value: '1-1'
              },
              {
                label: 'å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹2',
                value: '1-2'
              },
              {
                label: 'å­é€‰é¡¹3',
                value: '1-3'
              }
            ]
          },
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹ä¸‹æ‹‰é€‰é¡¹ä¸‹æ‹‰é€‰é¡¹2',
            options: [
              {
                label: 'å­é€‰é¡¹1',
                value: '2-1'
              },
              {
                label: 'å­é€‰é¡¹2',
                value: '2-2'
              },
              {
                label: 'å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹3',
                value: '2-3'
              }
            ]
          },
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹3',
            options: [
              {
                label: 'å­é€‰é¡¹1',
                value: '3-1'
              },
              {
                label: 'å­é€‰é¡¹2',
                value: '3-2'
              },
              {
                label: 'å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹3',
                value: '3-3'
              }
            ]
          },
          {
            label: 'ä¸‹æ‹‰é€‰é¡¹4',
            options: [
              {
                label: 'å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹å­é€‰é¡¹1',
                value: '4-1'
              },
              {
                label: 'å­é€‰é¡¹2',
                value: '4-2'
              },
              {
                label: 'å­é€‰é¡¹3',
                value: '4-3'
              }
            ]
          }
        ]
      },
      searchResult: null,
      complexData: [
        {
          label: 'å†…å®¹ç±»å‹',
          options: [
            { label: 'é€šç”¨', value: '1' },
            { label: 'é—®ç­”', value: '2' },
            { label: 'å¸¸è§é—®é¢˜', value: '3' }
          ]
        },
        {
          label: 'è¡Œä¸š',
          options: [
            {
              label: 'åŒ»ç–—æœåŠ¡',
              options: [{ label: 'A', value: 'a' }]
            },
            {
              label: 'æ•´å½¢ç¾å®¹',
              options: [
                { label: 'æ•´å½¢ç¾å®¹ç»¼åˆ', value: '4' },
                { label: 'æ•´å½¢ä¿®å¤å¤–ç§‘', value: '5' },
                { label: 'äº”å®˜æ•´å½¢', value: '6' },
                { label: 'å¾®æ•´å½¢', value: '7' },
                { label: 'å‡è‚¥å¡‘èº«', value: '8' },
                { label: 'æ¤å‘', value: '9' },
                { label: 'çº¹èº«', value: '10' },
                { label: 'å£è…”ç¾å®¹', value: '11' }
              ]
            },
            {
              label: 'åŒ»ç–—å™¨æ¢°',
              options: [{ label: 'B', value: 'b' }]
            },
            {
              label: 'æ•™è‚²åŸ¹è®­',
              options: [{ label: 'C', value: 'c' }]
            },
            {
              label: 'æ‹›å•†åŠ ç›Ÿ',
              options: [{ label: 'D', value: 'd' }]
            },
            {
              label: 'å•†åŠ¡æœåŠ¡',
              options: [{ label: 'E', value: 'e' }]
            },
            {
              label: 'åŠå…¬æ–‡æ•™',
              options: [{ label: 'F', value: 'f' }]
            },
            {
              label: 'ç½‘ç»œæœåŠ¡',
              options: [{ label: 'G', value: 'g' }]
            }
          ]
        },
        {
          label: 'ä¸šåŠ¡ç‚¹',
          options: [
            { label: 'å·¥ç¨‹å¸ˆåŸ¹è®­', value: '12' },
            { label: 'å¤§æ•°æ®åŸ¹è®­ç­', value: '13' },
            { label: 'åŒçœ¼çš®äº§å“ç±»', value: '14' },
            { label: 'åˆ†æ•£æœº', value: '15' },
            { label: 'ç¼–ç å™¨', value: '16' },
            { label: 'ç›¸äº²ä¸­ä»‹', value: '17' }
          ]
        }
      ]
    }
  },
  computed: {
    result () {
      return [
        { label: 'Foo', value: 'foo' },
        { label: 'Bar', value: 'bar' },
        { label: this.keyword, value: this.keyword }
      ]
    },
    groupedOpts () {
      return type
        .clone(this.optGroupAttrs.options)
        .map(group => {
          delete group.label
          delete group.position
          return group
        })
        .reduce((acc, cur) => {
          acc.push(cur)
          return acc
        }, [])
    },
    complexResult () {
      return this.searchResult
        ? (this.complex || [])
          .map(v => ({
            label: v + '**',
            value: v
          }))
          .concat(this.searchResult || [])
        : null
    }
  },
  mounted () {
    this.$children.forEach(child => {
      child.$on('click', () => {
        bus.$emit('log', child.$el.getAttribute('ui'))
      })
    })

    this.loaded = true
  },
  methods: {
    change (value) {
      // alert('æ‚¨é€‰ä¸­çš„ä¸‹æ‹‰é€‰é¡¹å€¼æ˜¯' + value)
    },
    handleSearch (val) {
      if (val) {
        this.searchResult = Array.from({
          length: 5
        }).map((_, i) => ({
          label: `${val}#${i}`,
          value: `${val}#${i}`
        }))
      } else {
        this.searchResult = null
      }
    }
  }
}
</script>

<style lang="less" scoped>
.veui-option-label {
  &-text,
  .veui-icon {
    vertical-align: middle;
  }

  .veui-icon {
    margin-left: 5px;
  }
}

.veui-option-custom {
  position: relative;
  padding-left: 24px;
  &::after {
    content: "â¤ï¸";
    position: absolute;
    top: 50%;
    left: 0;
    transform: translateY(-50%);
  }

  &-label {
    color: rgb(80, 170, 39);
  }
}

.filter {
  width: calc(100% - 10px);
  margin: 5px;
}

.note {
  margin: 8px;
  font-size: 12px;
  width: 240px;

  .veui-icon {
    float: left;
    margin-top: 3px;
    margin-right: 8px;
    margin-left: 8px;
  }

  .text {
    overflow: hidden;
  }
}

.veui-button {
  margin-left: 8px;
}
</style>
