@import "../lib.less";

.@{veui-prefix}-checkbox {
  display: inline-flex;
  align-items: baseline;
  position: relative;
  color: @dls-checkbox-font-color;
  cursor: pointer;

  input {
    position: absolute;
    opacity: 0;
    cursor: inherit;
  }

  &-box {
    position: relative;
    display: flex;
    flex-grow: 0;
    flex-shrink: 0;
    border: 1px solid @dls-checkbox-border-color;
    background-color: @dls-checkbox-background-color;
    color: @dls-checkbox-foreground-color;
    border-radius: @dls-checkbox-border-radius;
    .veui-transition(border-color, background-color, box-shadow);

    .@{veui-prefix}-icon {
      .absolute(50%, _, _, 50%);
      margin: auto;
      .dls-icon-size(@dls-checkbox-icon-size, @dls-checkbox-icon-min-size);
      transform: translate(-50%, -50%) scale(1.25);
      .veui-transition(transform, opacity);

      path {
        transform: scale(0.8);
        transform-origin: 50% 50%;
        stroke: currentcolor;
        stroke-width: 1px;
      }
    }
  }

  &-label {
    margin-left: @dls-checkbox-spacing;
    .veui-transition(color);
  }

  &-icon-enter,
  &-icon-leave-to {
    opacity: 0;
    transform: scale(0.5);
  }

  &:hover &-box {
    border-color: @dls-checkbox-border-color-hover;
    background-color: @dls-checkbox-background-color-hover;
    color: @dls-checkbox-foreground-color-hover;
  }

  & [data-focus-visible-added] + &-box {
    .dls-focus-ring(
      @dls-checkbox-border-color-focus,
      @dls-checkbox-shadow-focus
    );
    background-color: @dls-checkbox-background-color-focus;
    color: @dls-checkbox-foreground-color-focus;
  }

  &:active &-box {
    border-color: @dls-checkbox-border-color-active;
    background-color: @dls-checkbox-background-color-active;
    color: @dls-checkbox-foreground-color-active;
  }

  & :disabled + &-box {
    border-color: @dls-checkbox-border-color-disabled;
    background-color: @dls-checkbox-background-color-disabled;
    color: @dls-checkbox-foreground-color-disabled;
  }

  & :checked + &-box,
  & :indeterminate + &-box {
    border-color: @dls-checkbox-border-color-checked;
    background-color: @dls-checkbox-background-color-checked;
  }

  &:hover :checked + &-box,
  &:hover :indeterminate + &-box {
    border-color: @dls-checkbox-border-color-checked-hover;
    background-color: @dls-checkbox-background-color-checked-hover;
  }

  & :checked[data-focus-visible-added] + &-box,
  & :indeterminate[data-focus-visible-added] + &-box {
    border-color: @dls-checkbox-border-color-checked-focus;
    background-color: @dls-checkbox-background-color-checked-focus;
  }

  &:active :checked + &-box,
  &:active :indeterminate + &-box {
    border-color: @dls-checkbox-border-color-checked-active;
    background-color: @dls-checkbox-background-color-checked-active;
  }

  & :checked:disabled + &-box,
  & :indeterminate:disabled + &-box {
    border-color: @dls-checkbox-border-color-checked-disabled;
    background-color: @dls-checkbox-background-color-checked-disabled;
  }

  &.@{veui-prefix}-disabled {
    cursor: not-allowed;
    color: @dls-checkbox-font-color-disabled;
  }

  .make-size(@size) {
    @s: ~"dls-checkbox-size-@{size}";
    @fs: ~"dls-checkbox-font-size-@{size}";

    font-size: @@fs;
    line-height: dls-even(dls-line-height(@dls-line-height-1, @@fs));

    .@{veui-prefix}-checkbox-box {
      .size(@@s);

      &-labelled {
        // Baseline is around 0.1414em above bottom line for macOS's system font
        // see https://jsbin.com/yimugoxina/edit?html,css,js,output
        top: dls-sum(@@s / 2, -@@fs / 2, 0.1414em);
      }
    }
  }

  &[ui~="m"] {
    .make-size(m);
  }

  &[ui~="s"] {
    .make-size(s);
  }
}
